{% extends 'base.html' %}
{% load static %}

{% block title %}
home page
{% endblock %}

{% block body_block %}
<style>
    .form {
        width: 1000px;
        box-shadow: 0 0 3px 0 rgb(0, 0, 0, 0.3);
        background: white;
        padding: 20px;
        margin: 3% auto 0;
    }
</style>
{% csrf_token %}
<link rel="stylesheet" href="{% static 'plugins/bootstrap/signup.css' %}">
<div class="form">
    <div>
        <div>
            <div>
                <h3 style="text-align: center;">
                    Add Attraction Please
                </h3>
                <input type="hidden" id="dayRoute_Id" value="{{dayRouteObject.dayRouteId}}">

                <div>
                    这次旅行你比较喜欢的景点类型：
                    {% for i in recommendCategory %}
                    {{i.categoryName}},
                    {% endfor %}
                </div>
                <div>
                    你今天要去的城市是：
                    {% for i in todayCity %}
                    {% if i.cityName %}
                    {{ i.cityName }},
                    {% else %}
                    {{i}}
                    {% endif %}
                    {% endfor %}
                </div>
                <div>
                    根据您的喜欢，推荐的景点有这些：
                    <div>
                        {% for i in allAttractionResult %}
                        <div>
                            <input name="attraction" id="{{i.attractionId}}" type="checkbox" value="{{ i.attractionId }}">
                            {{i.attractionName}} ({{i.attractionLikes}})
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div>
                    除此之外以外，还有其他这个城市著名的景点：
                    <div>
                        {% for i in excludeReList %}
                    </div>
                    <div>
                        <input name="attraction" id="{{i.attractionId}}" type="checkbox" value="{{ i.attractionId }}">
                        {{i.attractionName}} ({{i.attractionLikes}})
                    </div>
                    {% endfor %}
                </div>
                <div>
                    <button type="submit" id="submit" onclick="addAttraction()" style="float: right;">Add</button>
                    <br />
                </div>
            </div>
        </div>
    </div>
</div>

<script language="JavaScript">

    function addAttraction() {
        console.log("hi")
        var radio = document.getElementsByName("attraction");
        console.log(radio)
        var post_data = new Array();
        var number = 0;
        for (var n = 0; n < radio.length; n++) {
            // 挑选出被选的单位
            if (radio[n].checked == true) {
                //console.log(radio[n]);
                //console.log(radio[n].value)
                post_data.push(radio[n].id);
                number++
            }
        }

        var dayRoute_Id = document.getElementById("dayRoute_Id").value
        console.log(dayRoute_Id)
        //console.log("giao.........////")

        //console.log(title);
        //console.log(days);
        all_data = {
            'dayRoute_Id': dayRoute_Id,
            'attraction': post_data,

        }


        $.ajax({
            type: "POST",
            url: "/addAttraction/",
            data: JSON.stringify(all_data),
            // data: {
            //     'post_data':post_data
            // },
            //---------giao----------
            dataType: 'json',
            //---------giao----------

            success: function (data) {
                window.location = data.msg

                console.log('giaogggggg');
            }
        })

    }
</script>


{% endblock %}